## TODO

- [ ] .d.ts
- [ ] read [wroker](src/vs/base/common/worker/simpleWorker.ts)
- [ ] read [actions](src/vs/base/common/actions.ts)
- [ ] read [async](src/vs/base/common/async.ts)
- [ ] [electron-sandbox](src/vs/base/parts/sandbox/)

## Knowledge
### ASAR
Simple extensive tar-like archive format with indexing provided by electron.

该项目中是将`node_modules`打包成`node_modules.asar`

有趣的是, vscode在这里代理了node中Module模块的`_resolveLookupPaths`方法, 借此来实现了`node_modules.arar`对`node_modules`的查找路径替换

``` js
	// @ts-ignore
	const originalResolveLookupPaths = Module._resolveLookupPaths;

	// @ts-ignore
	Module._resolveLookupPaths = function (request, parent) {
		const paths = originalResolveLookupPaths(request, parent);
		if (Array.isArray(paths)) {
			for (let i = 0, len = paths.length; i < len; i++) {
				if (paths[i] === NODE_MODULES_PATH) {
					paths.splice(i, 0, NODE_MODULES_ASAR_PATH);
					break;
				}
			}
		}

		return paths;
	};
```

## Nice Coding

### 集中创建, 简单即美
``` js
	const [instantiationService, instanceEnvironment, environmentService, configurationService, stateService, bufferLogService] = this.createServices(args);
```

### indexable types

``` js
	const seen: { [key: string]: boolean; } = Object.create(null);
```

### void 0
``` js
// https://stackoverflow.com/a/7452352
if (moduleIdResolver === void 0) {
	moduleIdResolver = new ModuleIdResolver(strModuleId);
}
```
### 对于require的安全性检查
``` js
	// check if `require` is a function first
	const Module = typeof require === 'function' ? require('module') : undefined;
	const path = typeof require === 'function' ? require('path') : undefined;
	const fs = typeof require === 'function' ? require('fs') : undefined
```

### election aip app.setPath(name, path)

You can only override paths of a `name` defined in [app.getPath](https://www.electronjs.org/docs/api/app#appgetpathname).

## Packages

### substack/minimist
parse argument options

[github](https://github.com/substack/minimist)

``` js
/**
 * 这是这个库在vscode中的用法
 */
minimist(['-s', '0001234', '-d', '0001234', '--verbose'], {string: ['s'], number: ['d'], boolean: ['verbose']})
// { _: [], verbose: true, s: '0001234', d: 1234 }
minimist(['-s', '0001234', '-d', '0001234'], {string: ['s'], number: ['d'], boolean: ['verbose']})
// { _: [], verbose: false, s: '0001234', d: 1234 }
```




